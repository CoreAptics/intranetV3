/*!
 * IntranetV3 v0.0.1 (http://thetheme.io/theadmin)
 * Copyright 2018 TheTheme.io / David Annebicque
 * Licensed under the Themeforest Standard Licenses
 */

"use strict";function readUrlMenu(a){if("/"!==a&&"/index.php/"!==a){var b=a.split("/"),c=0;console.log(b),"index.php"===b[1]&&b.length>1&&(c=2),$(".menu-item").removeClass("active"),$("#menu-"+b[c]).addClass("active")}else $("#menu-dashboard").addClass("active")}function addCallout(a,b){var c='<div class="callout callout-'+a+'" role="alert">\n                    <button type="button" class="close" data-dismiss="callout" aria-label="Close">\n                        <span>&times;</span>\n                    </button>\n                    <h5>'+a+"</h5>\n                    <p>"+b+"</p>\n                </div>";$("#mainContent").append(c).slideDown("slow"),$(".callout").delay(5e3).slideUp("slow")}app.config({autoload:!0,provide:["datatables","quill","momentjs","chartjs"],googleApiKey:"AIzaSyDRBLFOTTh2NFM93HpUA4ZrA99yKnCAsto",googleAnalyticsId:"",smoothScroll:!1,saveState:!1,cacheBust:""}),$(document).on("click",".supprimer",function(a){a.preventDefault();var b=$(this).attr("href"),c=$(this).data("csrf");swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",confirmButtonClass:"btn btn-primary",cancelButtonClass:"btn btn-secondary",buttonsStyling:!1}).then(function(a){console.log(a),a.value?(console.log(b),$.ajax({url:b,type:"DELETE",data:{_token:c},success:function(a){$("#ligne_"+a).closest("tr").remove(),swal("Deleted!","Your file has been deleted.","success")},error:function(a,b,c){swal("Error deleting!","Please try again","error")}})):"cancel"===a.dismiss&&swal("Cancelled","Your imaginary file is safe :)","error")})}),app.ready(function(){function a(){for(var a=0,b=0,c=0,d=0,f=0,g=0,h=1;h<=e;h++)a+=parseFloat($("#cm_"+h).val())*parseInt($("#gr_cm_"+h).val()),b+=parseFloat($("#td_"+h).val())*parseInt($("#gr_td_"+h).val()),c+=parseFloat($("#tp_"+h).val())*parseInt($("#gr_tp_"+h).val()),g=g+a+b+c,f=f+parseFloat($("#cm_"+h).val())+parseFloat($("#td_"+h).val())+parseFloat($("#tp_"+h).val());$("#totalCm").html(a.toFixed(2)),$("#totalTd").html(b.toFixed(2)),$("#totalTp").html(c.toFixed(2)),$("#totalEqTd").html(d.toFixed(2)),$("#totalEtu").html(f.toFixed(2)),$("#totalMatiere").html(g.toFixed(2))}function b(a,b){$.ajax({type:"GET",url:Routing.generate("application_personnel_absence_get_ajax.fr",{matiere:$("#absence-matiere").val()}),dataType:"json",success:function(a){f=a}});var c=a.split("/"),d=c[2].trim()+"-"+c[1].trim()+"-"+c[0].trim();if(void 0!==f[d]&&void 0!==f[d][b])for(var e=0;e<f[d][b].length;e++)$("#"+f[d][b][e]).addClass("absent")}readUrlMenu($(location).attr("pathname"));var c={decimal:"",emptyTable:"Aucune donn&eacute;e disponible dans le tableau",info:"Affichage de l'&eacute;l&eacute;ment _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",infoEmpty:"Affichage de l'&eacute;l&eacute;ment 0 &agrave; 0 sur 0 &eacute;l&eacute;ment",infoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",infoPostFix:"",thousands:",",lengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",loadingRecords:"Chargement en cours...",processing:"Traitement en cours...",search:"Rechercher&nbsp;:",zeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",paginate:{first:"Premier",last:"Dernier",next:"Suivant",previous:"Pr&eacute;c&eacute;dent"},aria:{sortAscending:": activer pour trier la colonne par ordre croissant",sortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}};$(document).on("click",".page-link",function(a){a.preventDefault(),a.stopPropagation();var b=$("#zone-pagination");b.empty(),b.load($(this).attr("href"))}),$(document).on("click",".changeprofil",function(a){a.preventDefault(),a.stopPropagation(),$(".changeprofil").removeClass("active show"),$(this).addClass("active show"),$("#profilContent").empty().load($(this).attr("href"))}),$(document).on("change",".addfavori",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("user_add_favori.fr"),method:"POST",data:{user:$(this).val(),etat:$(this).prop("checked")}})}),$(document).on("click",".afficheDocuments",function(){$("#zone_document").empty().load(Routing.generate("document_ajax",{typedocument:$(this).data("type")})),$("#boutonBack").show()}),$(document).on("click","#boutonBack",function(){$("#zone_document").empty().load(Routing.generate("typedocument_ajax")),$("#boutonBack").hide()}),$(document).on("click",".semestretrombi",function(a){a.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre.fr",{semestre:$(this).data("sem")})).slideDown()}),$(document).on("click",".changeTypeGroupe",function(a){a.preventDefault(),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_etudiant_semestre.fr",{semestre:$(this).data("semestre"),typegroupe:$(this).data("typegroupe")})).slideDown()}),$(document).on("click",".enseignanttrombi",function(a){a.preventDefault(),$(".semestretrombi").removeClass("active show"),$(".enseignanttrombi").removeClass("active show"),$(this).addClass("active show"),$("#trombi").slideUp().empty().load(Routing.generate("trombinoscope_personnel.fr",{type:$(this).data("type")})).slideDown()}),$(document).on("keyup","#login_urca",function(){var a=$(this).val();console.log(a),a.length>2&&$.ajax({url:Routing.generate("api_personnel_recherche",{needle:a}),dataType:"json",success:function(a){$("#result").empty(),jQuery.each(a,function(a,b){var c="<tr><td>"+b.nom+"</td><td>"+b.prenom+"</td><td>"+b.username+"</td><td>"+b.mail_univ+'</td><td><a href="#" class="btn btn-success btn-outline btn-square addpersonnel" data-provide="tooltip" data-placement="bottom" title="Ajouter à la formation" data-slug="'+b.slug+'"><i class="ti-plus"></i></a></td></tr>';$("#result").append(c)})}})}),$(document).on("click",".addpersonnel",function(){$.ajax({url:Routing.generate("api_personnel_add_to_formation",{slug:$(this).data("slug")}),dataType:"json",success:function(a){$(this).remove()}})}),$(document).on("click",".personnel_index_change",function(){$(".personnel_index_change").removeClass("active show"),$(this).addClass("active show");var a=$("#tableau").DataTable();a.clear(),a.destroy(),$.ajax({url:Routing.generate("api_enseignants_type",{type:$(this).data("type")}),dataType:"json",success:function(a){jQuery.each(a,function(a,b){var c="<tr>\n                        <td>"+b.nom+"</td>\n                        <td>"+b.prenom+"</td>\n                        <td>"+b.posteInterne+"</td>\n                        <td>"+b.telBureau+"</td>\n                        <td>"+b.bureau1+"</td>\n                        <td>"+b.numeroHarpege+"</td>\n                        <td>"+b.mailUniv+'</td>\n                        <td>\n<a href="'+Routing.generate("administration_personnel_show",{id:b.id})+'" class="btn btn-info btn-outline btn-square" data-provide="tooltip"\n   data-placement="bottom" title="Détails"><i class="ti-eye"></i></a>\n<a href="'+Routing.generate("administration_personnel_edit",{id:b.id})+'"\n   class="btn btn-warning btn-outline btn-square"><i class="ti-pencil"\n                                                     data-provide="tooltip"\n                                                     data-placement="bottom"\n                                                     title="Modifier"></i></a>\n<a href="'+Routing.generate("administration_personnel_delete",{id:b.id})+'" class="btn btn-danger btn-outline btn-square supprimer" data-id="id"><i\n            class="ti-close" data-provide="tooltip" data-placement="bottom"\n            title="Supprimer"></i></a>';$("#datatableau").append(c)}),$("#tableau").DataTable({})}})}),$("#datatableRh").DataTable({processing:!0,serverSide:!0,ajax:Routing.generate("api_all_personnel"),sAjaxDataProp:"data",pageLength:25,columns:[{data:"numero_harpege"},{data:"nom"},{data:"prenom"},{data:"formations"},{data:"profil"}]});var d=$("#datatableEtudiants").DataTable({});d.clear(),d.destroy(),$("#datatableEtudiants").DataTable({language:c,processing:!0,serverSide:!0,ajax:Routing.generate("api_etudiant_formation"),sAjaxDataProp:"data",columns:[{data:"numetudiant"},{data:"nom"},{data:"prenom"},{data:"semestre"},{data:"profil"}]}),$(document).on("click",".changeapplication",function(a){a.preventDefault(),a.stopPropagation(),$(".changeapplication").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))});var e=1;$(document).on("change","#previSemestre",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_semestre.fr",{semestre:$(this).val()}))}),$(document).on("change","#previMatiere",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_matiere.fr",{matiere:$(this).val()}))}),$(document).on("change","#previPersonnel",function(a){a.preventDefault(),a.stopPropagation(),$("#blocPrevisionnel").empty().load(Routing.generate("administration_previsionnel_personnel.fr",{personnel:$(this).val()}))}),$(document).on("click",".previsionnel_add_change",function(a){a.preventDefault(),a.stopPropagation(),$(".previsionnel_add_change").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("click","#addIntervenantPrevisionnel",function(a){a.preventDefault(),a.stopPropagation(),e++;var b='<tr>\n                        <td>\n                            <select class="form-control">\n                                <option value="">Choisir l\'intervenant</option>\n                            </select>\n                        </td>\n                        <td><input type="text" name="cm_1" id="cm_'+e+'" data-ligne="1" class="form-control chgcm" value="0"></td>\n                        <td><input type="number" name="gr_cm_1" id="gr_cm_'+e+'" value="0" data-ligne="1" class="form-control chgcm">\n                        </td>\n                        <td id="ind_cm_'+e+'">0</td>\n                        <td style="background-color: #68C39F"><input type="text" value="0" name="td_'+e+'" id="td_'+e+'" data-ligne="'+e+'"\n                                                                     class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F"><input type="number" value="0" name="gr_td_'+e+'" id="gr_td_'+e+'"\n                                                                     data-ligne="'+e+'" class="form-control chgtd"></td>\n                        <td style="background-color: #68C39F" id="ind_td_'+e+'">0</td>\n                        <td style="background-color: #FFC052"><input type="text" value="0" name="tp_'+e+'" id="tp_'+e+'" data-ligne="'+e+'"\n                                                                     class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052"><input type="number" value="0" name="gr_tp_'+e+'" id="gr_tp_'+e+'"\n                                                                     data-ligne="'+e+'" class="form-control chgtp"></td>\n                        <td style="background-color: #FFC052" id="ind_tp_'+e+'">0</td>\n                    </tr>';$("#nbLigne").val(e),$("#ligneAdd").before(b)}),$(document).on("change",".chgcm",function(b){var c=$(this).data("ligne"),d=parseFloat($("#cm_"+c).val())/1.5;$("#ind_cm_"+c).html(d.toFixed(2)),a()}),$(document).on("change",".chgtd",function(b){var c=$(this).data("ligne"),d=parseFloat($("#td_"+c).val())/1.5;$("#ind_td_"+c).html(d.toFixed(2)),a()}),$(document).on("change",".chgtp",function(b){var c=$(this).data("ligne"),d=parseFloat($("#tp_"+c).val())/1.5;$("#ind_tp_"+c).html(d.toFixed(2)),a()}),$(document).on("change","#previsionnel_semestre",function(){var a=$("#previsionnel_matiere");""==$(this).val()?(a.empty(),a.append($("<option></option>").attr("value","").text("Choisir d'abord un semestre"))):$.ajax({url:Routing.generate("api_matieres_semestre",{semestre:$(this).val()}),success:function(b){a.empty(),a.append($("<option></option>").attr("value","").text("Choisir une matière")),jQuery.each(b,function(b,c){a.append($("<option></option>").attr("value",c.id).text(c.libelle))})}})}),$(document).on("change","#previsionnel_matiere",function(){var a=$("#volumeMatiere");""==$(this).val()?a.html("Choisir d'abord une matière"):$.ajax({url:Routing.generate("api_matiere",{matiere:$(this).val()}),success:function(b){var c="PPN Officiel => CM "+b.cmFormation+" heure(s); TD "+b.tdFormation+" heure(s); TP "+b.tpFormation+" heure(s); PPN Réalisé/formation => CM "+b.cmPpn+" heure(s); TD "+b.tdPpn+" heure(s); TP "+b.tpPpn+" heure(s);";a.html(c)}})}),$(document).on("click",".previsionnelModule",function(){var a=$("#modalPrevisionnel");$.ajax({url:Routing.generate("api_previsionnel_matiere",{matiere:$(this).data("matiere")}),success:function(b){a.empty();var c='<table class="table table-bordered table-condensed">\n                    <thead>\n                    <tr>\n                        <th class="cm">NB h*</th>\n                        <th class="cm">NB Gr.</th>\n                        <th class="cm">1.5**</th>\n\n                        <th class="previtd">NB h/ Gr.*</th>\n                        <th class="previtd">NB Gr.</th>\n                        <th class="previtd">1.5**</th>\n\n                        <th class="previtp">NB h/ Gr.*</th>\n                        <th class="previtp">NB Gr.</th>\n                        <th class="previtp">1.5**</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n';jQuery.each(b,function(a,b){c=c+'                        <tr>\n                            <td colspan="9">\n                                '+b.personnel+"\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>"+b.nbHCm+" h</td>\n                            <td>"+b.nbGrCm+"</td>\n                            <td>"+b.nbSeanceCm+'</td>\n                            <td class="previtd">'+b.nbHTd+' h</td>\n                            <td class="previtd">'+b.nbGrTd+'</td>\n                            <td class="previtd">'+b.nbSeanceTd+'</td>\n                            <td class="previtp">'+b.nbHTp+' h</td>\n                            <td class="previtp">'+b.nbGrTp+'</td>\n                            <td class="previtp">'+b.nbSeanceTp+"</td>\n                        </tr>\n"}),c+="                    </tbody>\n                </table>",a.append(c)}})}),$(document).on("click",".changeinformation",function(a){a.preventDefault(),a.stopPropagation(),console.log($(this).text()),$("#header-title").empty().append($(this).text()),$(".changeinformation").removeClass("active show"),$(this).addClass("active show"),$("#mainContent").empty().load($(this).attr("href"))}),$(document).on("change",".changeOption",function(a){a.preventDefault(),a.stopPropagation(),console.log($(this)),console.log(),$.ajax({url:Routing.generate("administration_configuration_change_option.fr"),method:"POST",data:{type:$(this).data("type"),value:$(this).prop("checked"),name:$(this).attr("name"),id:$(this).data("id")}})}),$(document).on("change",".changeOptionSelect",function(a){a.preventDefault(),a.stopPropagation(),console.log($(this)),console.log(),$.ajax({url:Routing.generate("administration_configuration_change_option.fr"),method:"POST",data:{type:$(this).data("type"),value:$(this).val(),name:$(this).attr("name"),id:$(this).data("id")}})}),$(document).on("click",".messagerie-filtre",function(a){a.preventDefault(),a.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_filtre",{filtre:$(this).data("filtre")}))}),$(document).on("click",".message-read",function(a){a.preventDefault(),a.stopPropagation(),$("#messages-liste").empty().load(Routing.generate("messagerie_message",{message:$(this).data("message")}))}),$(document).on("click","#message-new",function(a){a.preventDefault(),a.stopPropagation(),$("#zone-messagerie").empty().load(Routing.generate("messagerie_new"))}),$(document).on("click","#marquerNotificationsRead",function(a){a.preventDefault(),a.stopPropagation(),$.ajax({url:Routing.generate("notification_marquer_lu"),success:function(a){$(".notification").removeClass("media-new")}})});var d=$("#tableJustifier").DataTable({retrieve:!0}),f=new Array;$(document).on("change","#justifier_etudiant",function(a){$.ajax({url:Routing.generate("administration_absences_liste_absence_etudiant.fr",{etudiant:$(this).val()}),success:function(a){console.log("ok"),d.rows().remove(),jQuery.each(data,function(a,b){d.row.add([1,2,'<a href="" class="btn btn-danger supprimer"><i class="ti-close"></i></a>']).draw()})}})}),$(document).on("click",".absChangeTypeGroupe",function(a){a.preventDefault(),a.stopPropagation(),$("#listeEtudiantsAbsences").load(Routing.generate("api_absence_liste_etudiant",{typegroupe:$(this).data("typegroupe")}));var c=$("#absence-date"),d=$("#absence-heure");b(c.val(),d.val())}),$(document).on("change","#absence-matiere",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("change","#absence-date",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("change","#absence-heure",function(){var a=$(".etudiant"),c=$("#absence-date"),d=$("#absence-heure");a.removeClass("absent"),b(c.val(),d.val())}),$(document).on("click",".etudiant",function(){$(this).hasClass("absent")?($(this).removeClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax.fr",{matiere:$("#absence-matiere").val(),etudiant:$(this).attr("id")}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"suppr"},error:function(a,b){addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la formation","error")},success:function(a){f=a,addCallout("La suppression a été effectuée avec succés !","success")}})):($(this).addClass("absent"),$.ajax({type:"POST",url:Routing.generate("application_personnel_absence_saisie_ajax.fr",{matiere:$("#absence-matiere").val(),etudiant:$(this).attr("id")}),dataType:"json",data:{date:$("#absence-date").val(),heure:$("#absence-heure").val(),action:"saisie"},error:function(a,b){"out"==a.responseText?addCallout("Le délai pour l'enregistrement est dépassé. Contactez le responsable de la formation","error"):addCallout("Erreur lors de l'enregistrement.","error")},success:function(a){f=a,console.log("ajout"),console.log(f),addCallout("Absence enregistrée avec succés !","success")}}))}),$("#liste-absences").dataTable({language:c,fnRowCallback:function(a,b,c,d){"non"==b[6]||"no"==b[6]||"No"==b[6]||"Non"==b[6]?$("td",a).css("background-color","#fce3e3"):$("td",a).css("background-color","#e3fcf2")}}),$(document).on("click",".articleLike",function(a){a.preventDefault(),a.stopPropagation();var b=$(this);$.ajax({url:Routing.generate("article_like.fr",{slug:$(this).data("article")}),success:function(a){b.html('<i class="ti-heart text-danger fs-11"></i> '+a)}})}),$("#editCourrier");var g=$(".preloader");if(g.length){var h=g.dataAttr("hide-spped",600);g.fadeOut(h)}$(document).on({ajaxStart:function(){g.show()},ajaxStop:function(){g.hide()}}),$(".callout").delay(5e3).slideUp("slow")});